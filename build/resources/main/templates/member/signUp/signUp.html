<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
회원가입<br><br>

<form action="/bangbang/auth/sign-in" method="post">
    아이디: <input type="text" name="person_id" id="user-id"><br>
    비밀번호: <input type="password" name="passwd" id="user-passwd"><br>
    비밀번호 확인: <input type="password"><br>
    닉네임: <input type="text" name="user_name" id="user-name"><br>
    나이: <input type="text" name="old" id="user-old"><br>
    전화번호: <input type="text" name="phone_num" id="user-phone"><br>
    <button type="button" id="join-btn">회원가입</button>
</form>

<script>

    //댓글 생성 버튼 변수화
    const commentCreateBtn = document.querySelector("#join-btn");

    //버튼 클릭 이벤트 감지
    commentCreateBtn.addEventListener("click",function () {
        //새 댓글 객체 생성
        const user = {
            person_id: document.querySelector("#user-id").value,
            passwd: document.querySelector("#user-passwd").value,
            user_name: document.querySelector("#user-name").value,
            old: document.querySelector("#user-old").value,
            phone_num: document.querySelector("#user-phone").value
        };

        console.log(user);

        // fetch() - Talend API 요청을 JavaScript로 보내준다!
        const url = "/bangbang/auth/sign-in";
        fetch(url, {
            method: "post",                 // post 요청
            body: JSON.stringify(user),  //comment JS 객체를 JSON으로 변경하여 보냄
            headers: {
                "Content-Type": "application/json"
            }
        }).then(response => {       //respones가 응답이 온다면 다음과 같이 하자
            // http 응답 코드에 따른 메세지 출력
            const msg = (response.ok) ? "회원가입이 되었습니다" : "회원가입 실패"
            alert(msg);
            //현재 페이지 새로 고침
            window.location.href = "/bangbang/auth/sign-up";
        })
    })
</script>

</body>
</html>